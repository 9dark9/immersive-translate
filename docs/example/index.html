<!DOCTYPE html>
<html>
  <head>
    <title>Title</title>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <style>
      .source-element :not(.target) {
        display: none;
      }
    </style>
  </head>
  <body>
    <article id="article">
      <div role="paragraph">
        The total CO<sub>2</sub> adsorption amounts for ZrO<sub>2</sub>, 13%
        ZnO-ZrO<sub>2</sub>, and ZrO<sub>2</sub> are 100, 82, and 82
        mmol/m<sup>2</sup>, respectively.
      </div>
      <div>The test<code>test</code></div>
    </article>
    <script>
      const chineseRegex =
        /[\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u3005\u3007\u3021-\u3029\u3038-\u303B\u3400-\u4DBF\u4E00-\u9FFF\uF900-\uFA6D\uFA70-\uFAD9]|\uD81B[\uDFE2\uDFE3\uDFF0\uDFF1]|[\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD887][\uDC00-\uDFFF]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF39\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD888[\uDC00-\uDFAF]/g;

      const japaneseRegex =
        /[\u3041-\u3096\u309D-\u309F]|\uD82C[\uDC01-\uDD1F\uDD32\uDD50-\uDD52]|\uD83C\uDE00|[\u30A1-\u30FA\u30FD-\u30FF\u31F0-\u31FF\u32D0-\u32FE\u3300-\u3357\uFF66-\uFF6F\uFF71-\uFF9D]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00\uDD20-\uDD22\uDD55\uDD64-\uDD67]|[㐀-䶵一-龯]/g;

      const koreanRegex =
        /[\u1100-\u11FF\u302E\u302F\u3131-\u318E\u3200-\u321E\u3260-\u327E\uA960-\uA97C\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uFFA0-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]/g;
      const punctuationRegex = /(\s+)|([\p{P}\p{S}])/gu;

      const regexGroups = [
        ["zh-CN", chineseRegex],
        ["ja", japaneseRegex],
        ["ko", koreanRegex],
      ];

      function detectChinese(text) {
        if (!text) {
          return "auto";
        }
        let maxCountLang = "auto";
        let currentMaxCount = 0;
        let punctuationMatchesLength = 0;
        const punctuationMatches = text.match(punctuationRegex);
        if (punctuationMatches) {
          punctuationMatchesLength = punctuationMatches.reduce((sum, item) => {
            return sum + item.length;
          }, 0);
        }
        const allLettersLength = text.length - punctuationMatchesLength;
        for (const group of regexGroups) {
          const regex = group[1];
          const lang = group[0];
          const matches = text.match(regex);

          const langLength = matches ? matches.length : 0;
          if (langLength > currentMaxCount) {
            currentMaxCount = langLength;
            maxCountLang = lang;
          }
        }

        if ((currentMaxCount * 2.5) / allLettersLength > 0.5) {
          return maxCountLang;
        }
        return "auto";
      }

      const a = detectChinese("你好");
      console.log("a", a);
    </script>
  </body>
</html>
